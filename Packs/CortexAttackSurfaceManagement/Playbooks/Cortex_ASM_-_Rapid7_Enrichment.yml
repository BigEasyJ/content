id: Cortex ASM - Rapid7 Enrichment
version: -1
name: Cortex ASM - Rapid7 Enrichment
description: Given the IP address this playbook enriches Rapid7 InsightVM (Nexpose) information relevant to ASM alerts.
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 235e7bd1-e9cf-4c22-8b99-1782fe2157c5
    type: start
    task:
      id: 235e7bd1-e9cf-4c22-8b99-1782fe2157c5
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "14"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 460,
          "y": -220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: 0d418542-43fa-425b-82f0-7fd4a186c91a
    type: playbook
    task:
      id: 0d418542-43fa-425b-82f0-7fd4a186c91a
      version: -1
      name: Rapid7 - Nexpose - Enrichment
      description: Given an IP address, this playbook searches Rapid7 Nexpose assets for an asset with the associated IP address to retrieve asset information and proceeds to return all associated tags with it.
      playbookName: Rapid7 - Nexpose - Enrichment
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "8"
    scriptarguments:
      IP:
        complex:
          root: inputs.IPAddress
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 1190,
          "y": 210
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: 12724173-e326-487c-8119-500e1cbf5870
    type: regular
    task:
      id: 12724173-e326-487c-8119-500e1cbf5870
      version: -1
      name: Set service owner grid field
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "29"
    scriptarguments:
      gridfield:
        simple: asmserviceowner
      keys:
        simple: Name,Email,Source,Timestamp
      val1:
        complex:
          root: Nexpose.AssetTag
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: Nexpose.AssetTag.Type
                iscontext: true
              right:
                value:
                  simple: owner
          transformers:
          - operator: getField
            args:
              field:
                value:
                  simple: Name
      val2:
        simple: n/a
      val3:
        simple: Rapid7
      val4:
        complex:
          root: TimeNowUnix
          transformers:
          - operator: TimeStampToDate
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1190,
          "y": 1125
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: 4969c1bc-3b77-41c6-88cc-d96e779a6b6e
    type: regular
    task:
      id: 4969c1bc-3b77-41c6-88cc-d96e779a6b6e
      version: -1
      name: Get current time
      description: |
        Retrieves the current date and time.
      scriptName: GetTime
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "5"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1190,
          "y": 965
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "7":
    id: "7"
    taskid: 7cf9e4eb-c4c5-496e-81df-4057491ada71
    type: title
    task:
      id: 7cf9e4eb-c4c5-496e-81df-4057491ada71
      version: -1
      name: Service Owner
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "6"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1190,
          "y": 815
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: c51158db-2076-4297-8039-6faecbc440a4
    type: title
    task:
      id: c51158db-2076-4297-8039-6faecbc440a4
      version: -1
      name: Set Field
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "20"
      - "21"
      - "22"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1190,
          "y": 420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "9":
    id: "9"
    taskid: e1066c37-eb57-4fe3-80ef-9ce8ddc93908
    type: title
    task:
      id: e1066c37-eb57-4fe3-80ef-9ce8ddc93908
      version: -1
      name: System IDs
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "24"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1630,
          "y": 815
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: 5e8ae572-2b0f-4eb6-8167-436502977b8c
    type: regular
    task:
      id: 5e8ae572-2b0f-4eb6-8167-436502977b8c
      version: -1
      name: Set system IDs grid field (OS)
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "25"
    scriptarguments:
      gridfield:
        simple: asmsystemids
      keys:
        simple: Type,ID,Link
      val1:
        simple: Rapid7-OS
      val2:
        complex:
          root: Nexpose.Asset
          accessor: OperatingSystem
      val3:
        simple: n/a
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1860,
          "y": 1100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: 4aa38d4a-f56e-43b1-885f-bc04e5071dbc
    type: title
    task:
      id: 4aa38d4a-f56e-43b1-885f-bc04e5071dbc
      version: -1
      name: Tags
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "23"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 750,
          "y": 815
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: 229042cb-b624-422b-81ef-31e76890df41
    type: condition
    task:
      id: 229042cb-b624-422b-81ef-31e76890df41
      version: -1
      name: Is Rapid7 Nexpose enabled?
      description: Determines if the "Rapid7 Nexpose" integration instance is enabled in order to find assets and asset tags.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "34"
      "yes":
      - "1"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: modules
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: modules.brand
                      iscontext: true
                    right:
                      value:
                        simple: Rapid7 Nexpose
                - - operator: isEqualString
                    left:
                      value:
                        simple: modules.state
                      iscontext: true
                    right:
                      value:
                        simple: active
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 460,
          "y": -80
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "17":
    id: "17"
    taskid: a9790177-d862-41b9-87d1-45594b80526b
    type: regular
    task:
      id: a9790177-d862-41b9-87d1-45594b80526b
      version: -1
      name: Set system IDs grid field (Asset Site)
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "28"
    scriptarguments:
      gridfield:
        simple: asmsystemids
      keys:
        simple: Type,ID,Link
      val1:
        simple: Rapid7-Asset-Site
      val2:
        complex:
          root: Nexpose.Asset
          accessor: Site
      val3:
        simple: n/a
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1880,
          "y": 1790
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "18":
    id: "18"
    taskid: fc65c5e2-50f0-4106-8f60-ac9a4c292c21
    type: regular
    task:
      id: fc65c5e2-50f0-4106-8f60-ac9a4c292c21
      version: -1
      name: Set system IDs grid field (Asset Name)
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "26"
    scriptarguments:
      gridfield:
        simple: asmsystemids
      keys:
        simple: Type,ID,Link
      val1:
        simple: Rapid7-Asset
      val2:
        complex:
          root: Nexpose.Asset
          accessor: Name
      val3:
        simple: n/a
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1870,
          "y": 1440
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: 7d5a98ed-0f5d-4653-86ed-89a631128ed6
    type: condition
    task:
      id: 7d5a98ed-0f5d-4653-86ed-89a631128ed6
      version: -1
      name: Was there an asset from Rapid7?
      description: Checks if the Nexpose Asset object exists.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "34"
      "yes":
      - "9"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: Nexpose
                accessor: Asset
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1630,
          "y": 570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "21":
    id: "21"
    taskid: ca794b8e-f126-45e3-868c-658f7488e4d9
    type: condition
    task:
      id: ca794b8e-f126-45e3-868c-658f7488e4d9
      version: -1
      name: Was there asset tags from Rapid7?
      description: Checks if the Nexpose AssetTag object exists.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "34"
      "yes":
      - "11"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: Nexpose.AssetTag
                filters:
                - - operator: isNotEqualString
                    left:
                      value:
                        simple: Nexpose.AssetTag.Type
                      iscontext: true
                    right:
                      value:
                        simple: owner
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 750,
          "y": 570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "22":
    id: "22"
    taskid: ac28a69e-cbb3-487f-870e-8a9e8b2aadb7
    type: condition
    task:
      id: ac28a69e-cbb3-487f-870e-8a9e8b2aadb7
      version: -1
      name: Was there an owner asset tag from Rapid7?
      description: Checks if the Nexpose AssetTag object exists with an "owner" tag.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "34"
      "yes":
      - "7"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: Nexpose.AssetTag
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: Nexpose.AssetTag.Type
                      iscontext: true
                    right:
                      value:
                        simple: owner
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1190,
          "y": 570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "23":
    id: "23"
    taskid: 4aca13c6-3ff5-4d60-8896-d82072074501
    type: regular
    task:
      id: 4aca13c6-3ff5-4d60-8896-d82072074501
      version: -1
      name: Set tags grid field
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "29"
    scriptarguments:
      gridfield:
        simple: asmtags
      keys:
        simple: Key,Value,Source
      val1:
        complex:
          root: Nexpose.AssetTag
          filters:
          - - operator: isNotEqualString
              left:
                value:
                  simple: Nexpose.AssetTag.Type
                iscontext: true
              right:
                value:
                  simple: owner
          accessor: Type
      val2:
        complex:
          root: Nexpose.AssetTag
          filters:
          - - operator: isNotEqualString
              left:
                value:
                  simple: Nexpose.AssetTag.Type
                iscontext: true
              right:
                value:
                  simple: owner
          accessor: Name
      val3:
        simple: Rapid7
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 750,
          "y": 965
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "24":
    id: "24"
    taskid: b5c9ddaa-16cd-4054-85ef-a726bef25bdd
    type: condition
    task:
      id: b5c9ddaa-16cd-4054-85ef-a726bef25bdd
      version: -1
      name: Is an OS value set for asset?
      description: Checks if the Operating Service is set in the Nexpose Asset object.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "25"
      "yes":
      - "10"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Nexpose.Asset.OperatingSystem
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1630,
          "y": 925
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "25":
    id: "25"
    taskid: eaf75df8-482f-4efc-8662-b72a0963d32b
    type: condition
    task:
      id: eaf75df8-482f-4efc-8662-b72a0963d32b
      version: -1
      name: Is a name value set for asset?
      description: Checks if the Name is set in the Nexpose Asset object.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "26"
      "yes":
      - "18"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Nexpose.Asset
                accessor: Name
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1630,
          "y": 1270
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "26":
    id: "26"
    taskid: d285cb02-ed11-44f1-800b-534abcc8aa5d
    type: condition
    task:
      id: d285cb02-ed11-44f1-800b-534abcc8aa5d
      version: -1
      name: Is a site value set for asset?
      description: Checks if the Site is set in the Nexpose Asset object.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "28"
      "yes":
      - "17"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Nexpose.Asset
                accessor: Site
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1630,
          "y": 1615
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "27":
    id: "27"
    taskid: e889c72b-fd8b-4215-8b2e-a459c4212067
    type: regular
    task:
      id: e889c72b-fd8b-4215-8b2e-a459c4212067
      version: -1
      name: Set system IDs grid field (Asset ID)
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "29"
    scriptarguments:
      gridfield:
        simple: asmsystemids
      keys:
        simple: Type,ID,Link
      val1:
        simple: Rapid7-Asset-ID
      val2:
        complex:
          root: Nexpose.Asset
          accessor: AssetId
      val3:
        simple: n/a
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1880,
          "y": 2130
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "28":
    id: "28"
    taskid: 45035ac9-9956-47d0-84ac-e1ff270a5b35
    type: condition
    task:
      id: 45035ac9-9956-47d0-84ac-e1ff270a5b35
      version: -1
      name: Is a ID value set for asset?
      description: Checks if the Site is set in the Nexpose Asset object.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "27"
      - "29"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Nexpose.Asset
                accessor: AssetId
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1630,
          "y": 1960
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "29":
    id: "29"
    taskid: 04f002fd-98af-4114-8a8d-80f40e0d77bc
    type: regular
    task:
      id: 04f002fd-98af-4114-8a8d-80f40e0d77bc
      version: -1
      name: Set flag for enrichment status to true
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "32"
    scriptarguments:
      key:
        simple: asm_enrichment_status_rapid7
      value:
        simple: "true"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1190,
          "y": 2320
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "30":
    id: "30"
    taskid: 0696ec2d-d2c8-4c3c-836a-94807def6f39
    type: title
    task:
      id: 0696ec2d-d2c8-4c3c-836a-94807def6f39
      version: -1
      name: Complete
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 390,
          "y": 2870
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "32":
    id: "32"
    taskid: 331c8e5c-14ec-4409-8d10-0d8ee13e1ccb
    type: title
    task:
      id: 331c8e5c-14ec-4409-8d10-0d8ee13e1ccb
      version: -1
      name: Closing Steps
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "33"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 390,
          "y": 2540
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "33":
    id: "33"
    taskid: b78ddebf-5b4e-4e74-8bf2-25b33d87b175
    type: regular
    task:
      id: b78ddebf-5b4e-4e74-8bf2-25b33d87b175
      version: -1
      name: Set ASM enrichment status
      description: |-
        Automation used to more easily populate a grid field.  This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well.  Instead of a value you can enter `TIMESTAMP` to get the current timestamp in ISO format. For example:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "30"
    scriptarguments:
      gridfield:
        simple: asmenrichmentstatus
      keys:
        simple: source,record_exists,timestamp
      val1:
        simple: Rapid7
      val2:
        simple: ${asm_enrichment_status_rapid7}
      val3:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 390,
          "y": 2690
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "34":
    id: "34"
    taskid: a191a20a-6b8c-41cb-8755-528827a64f2a
    type: regular
    task:
      id: a191a20a-6b8c-41cb-8755-528827a64f2a
      version: -1
      name: Set flag for enrichment status to false
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "32"
    scriptarguments:
      key:
        simple: asm_enrichment_status_rapid7
      value:
        simple: "false"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 390,
          "y": 2100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {
      "14_1_yes": 0.46,
      "20_34_#default#": 0.1,
      "20_9_yes": 0.46,
      "21_11_yes": 0.54,
      "21_34_#default#": 0.1,
      "22_34_#default#": 0.1,
      "22_7_yes": 0.47,
      "24_10_yes": 0.6,
      "25_18_yes": 0.55,
      "28_29_yes": 0.32
    },
    "paper": {
      "dimensions": {
        "height": 3155,
        "width": 1870,
        "x": 390,
        "y": -220
      }
    }
  }
inputs:
- key: IPAddress
  value:
    complex:
      root: alert
      accessor: remoteip
      transformers:
      - operator: uniq
  required: true
  description: IP addresses to enrich.
  playbookInputQuery:
outputs: []
fromversion: 6.8.0
tests:
- No tests (auto formatted)
