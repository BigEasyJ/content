id: Cortex ASM - Azure Enrichment
version: -1
name: Cortex ASM - Azure Enrichment
description: Given the IP address, this playbook enriches Azure information relevant to ASM alerts.
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: a89fef24-029a-4030-8ab5-8c64dc8bfe56
    type: start
    task:
      id: a89fef24-029a-4030-8ab5-8c64dc8bfe56
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "27"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 450,
          "y": -320
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: 805593ee-fcb4-4970-8129-39fa84067a18
    type: title
    task:
      id: 805593ee-fcb4-4970-8129-39fa84067a18
      version: -1
      name: Set Fields
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "3"
      - "4"
      - "7"
      - "25"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 450,
          "y": -30
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: 74e03210-9c6c-4073-8cd3-038aa8d8f525
    type: condition
    task:
      id: 74e03210-9c6c-4073-8cd3-038aa8d8f525
      version: -1
      name: Is there IAM information?
      description: Determines if there is IAM information to set in the service owner field.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "42"
      "yes":
      - "9"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MSGraphUser
            iscontext: true
          right:
            value: {}
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Account
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -440,
          "y": 160
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: ba32b188-e55e-410d-8e7a-ecc5fbd1a052
    type: condition
    task:
      id: ba32b188-e55e-410d-8e7a-ecc5fbd1a052
      version: -1
      name: Is there Azure compute information?
      description: Determines if there is Azure Compute information to set in the system ID fields.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "11"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Azure
                accessor: Compute
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 240,
          "y": 160
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "7":
    id: "7"
    taskid: 7089d283-9daa-4bc9-85ff-ca60d09fd07e
    type: condition
    task:
      id: 7089d283-9daa-4bc9-85ff-ca60d09fd07e
      version: -1
      name: Is there Azure network information?
      description: Determines if there is Azure network information to set in the ASM Private IP field.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "43"
      "yes":
      - "18"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Azure
                accessor: Network
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1390,
          "y": 160
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: a02aee42-4c31-4f77-8abf-1fd411c59f12
    type: regular
    task:
      id: a02aee42-4c31-4f77-8abf-1fd411c59f12
      version: -1
      name: Set service owner grid field
      description: Sets the potential Azure service owner to the grid field for the ASM service owner object.
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "39"
    scriptarguments:
      gridfield:
        simple: asmserviceowner
      keys:
        simple: Name,Email,Source,Timestamp
      val1:
        complex:
          root: Account
          accessor: DisplayName
      val2:
        complex:
          root: Account
          filters:
          - - operator: isEmpty
              left:
                value:
                  simple: Account.Email.Address
                iscontext: true
            - operator: isNotEmpty
              left:
                value:
                  simple: Account.Email.Address
                iscontext: true
          transformers:
          - operator: getField
            args:
              field:
                value:
                  simple: Email
          - operator: getField
            args:
              field:
                value:
                  simple: Address
          - operator: SetIfEmpty
            args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: n/a
      val3:
        simple: Azure
      val4:
        complex:
          root: TimeNowUnix
          transformers:
          - operator: TimeStampToDate
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -440,
          "y": 540
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "9":
    id: "9"
    taskid: 35e9130e-9d4c-454f-8c8f-0bd3771d8502
    type: title
    task:
      id: 35e9130e-9d4c-454f-8c8f-0bd3771d8502
      version: -1
      name: Service Owner
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "8"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -440,
          "y": 395
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: b32b5221-7db6-47b1-831a-676e747e9852
    type: title
    task:
      id: b32b5221-7db6-47b1-831a-676e747e9852
      version: -1
      name: System IDs
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "12"
      - "42"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 240,
          "y": 395
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "12":
    id: "12"
    taskid: f31caa5a-c188-4899-82e4-a1dffdba1b70
    type: regular
    task:
      id: f31caa5a-c188-4899-82e4-a1dffdba1b70
      version: -1
      name: Set system IDs grid field (NSG)
      description: Sets Azure NSG information to the grid field for the ASM system IDs object.
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "13"
    scriptarguments:
      gridfield:
        simple: asmsystemids
      keys:
        simple: Type,ID,Link
      val1:
        simple: Azure-NSG
      val2:
        complex:
          root: Azure.Network.Interfaces.NetworkSecurityGroup
          accessor: id
          transformers:
          - operator: substringFrom
            args:
              from:
                value:
                  simple: networkSecurityGroups/
      val3:
        simple: n/a
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 240,
          "y": 540
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "13":
    id: "13"
    taskid: d87ef7f4-935a-49db-8c37-b0bcf6f9ba1d
    type: regular
    task:
      id: d87ef7f4-935a-49db-8c37-b0bcf6f9ba1d
      version: -1
      name: Set system IDs grid field (Resource Group)
      description: Sets Azure resource group information to the grid field for the ASM system IDs object.
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      gridfield:
        simple: asmsystemids
      keys:
        simple: Type,ID,Link
      val1:
        simple: Azure-RG
      val2:
        complex:
          root: Azure.Compute
          accessor: ResourceGroup
      val3:
        simple: n/a
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 240,
          "y": 705
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: aeb1e8bc-1b5a-4f09-89b6-3090c252853c
    type: regular
    task:
      id: aeb1e8bc-1b5a-4f09-89b6-3090c252853c
      version: -1
      name: Set system IDs grid field (NIC)
      description: Sets Azure NIC information to the grid field for the ASM system IDs object.
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "16"
    scriptarguments:
      gridfield:
        simple: asmsystemids
      keys:
        simple: Type,ID,Link
      val1:
        simple: Azure-NIC
      val2:
        complex:
          root: Azure.Compute.NetworkInterfaces
          accessor: id
          transformers:
          - operator: substringFrom
            args:
              from:
                value:
                  simple: networkInterfaces/
      val3:
        simple: n/a
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 240,
          "y": 870
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "16":
    id: "16"
    taskid: 131990c0-3196-4041-8ad1-594551fa6960
    type: regular
    task:
      id: 131990c0-3196-4041-8ad1-594551fa6960
      version: -1
      name: Set system IDs grid field (ID)
      description: Sets the Azure Compute instance ID to the grid field for the ASM system IDs object.
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "23"
    scriptarguments:
      gridfield:
        simple: asmsystemids
      keys:
        simple: Type,ID,Link
      val1:
        simple: Azure-Compute-ID
      val2:
        complex:
          root: Azure.Compute
          accessor: ID
      val3:
        simple: n/a
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 240,
          "y": 1040
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "17":
    id: "17"
    taskid: 45d03932-e4d0-4d7e-8ef9-c302c2b92776
    type: regular
    task:
      id: 45d03932-e4d0-4d7e-8ef9-c302c2b92776
      version: -1
      name: Set private IP grid field
      description: Sets the private IP to the grid field for the ASM private IP object.
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "30"
    scriptarguments:
      gridfield:
        simple: asmprivateip
      keys:
        simple: IP,Source
      val1:
        complex:
          root: Azure.Network.Interfaces.IPConfigurations
          accessor: PrivateIPAddress
      val2:
        simple: Azure
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1390,
          "y": 540
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "18":
    id: "18"
    taskid: de5d940d-e42e-4b3d-84dc-076b87efe352
    type: title
    task:
      id: de5d940d-e42e-4b3d-84dc-076b87efe352
      version: -1
      name: Private IP
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "17"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1390,
          "y": 405
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "19":
    id: "19"
    taskid: ee4c3636-4eca-4a77-8a58-559fccad6d81
    type: title
    task:
      id: ee4c3636-4eca-4a77-8a58-559fccad6d81
      version: -1
      name: Cloud
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "20"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 750,
          "y": 395
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: 31448eb4-47c7-442f-892e-0f3fc2c75804
    type: regular
    task:
      id: 31448eb4-47c7-442f-892e-0f3fc2c75804
      version: -1
      name: Set cloud grid field
      description: Sets Azure subscription, resource group, and location information to the grid field for the ASM cloud object.
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "31"
    scriptarguments:
      gridfield:
        simple: asmcloud
      keys:
        simple: Provider,Organization,Project,Region,Other
      val1:
        simple: Azure
      val2:
        complex:
          root: Azure.Compute.NetworkInterfaces
          accessor: id
          transformers:
          - operator: ExtractInbetween
            args:
              from:
                value:
                  simple: subscriptions/
              to:
                value:
                  simple: /resourceGroups
      val3:
        complex:
          root: Azure.Compute
          accessor: ResourceGroup
      val4:
        complex:
          root: Azure.Compute
          accessor: Location
      val5:
        simple: n/a
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 750,
          "y": 530
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "23":
    id: "23"
    taskid: 6e5353dd-ae41-4802-8f03-e10c4c8e7109
    type: regular
    task:
      id: 6e5353dd-ae41-4802-8f03-e10c4c8e7109
      version: -1
      name: Set system IDs grid field (Compute Name)
      description: Sets the Azure Compute instance name to the grid field for the ASM system IDs object.
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "38"
    scriptarguments:
      gridfield:
        simple: asmsystemids
      keys:
        simple: Type,ID,Link
      val1:
        simple: Azure-Compute-Name
      val2:
        complex:
          root: Azure.Compute
          accessor: Name
      val3:
        simple: n/a
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 240,
          "y": 1210
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "25":
    id: "25"
    taskid: e37faff3-ad92-4ef8-8f7b-289fa202ccaf
    type: condition
    task:
      id: e37faff3-ad92-4ef8-8f7b-289fa202ccaf
      version: -1
      name: Is there Azure compute information?
      description: Determines if there is Azure Compute information to set in the Cloud ASM fields.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "43"
      "yes":
      - "19"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Azure
                accessor: Compute
            iscontext: true
          right:
            value: {}
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Azure
                accessor: Network
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 750,
          "y": 160
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "27":
    id: "27"
    taskid: ae1b8862-e82b-47d0-8ae0-eadc4807d547
    type: playbook
    task:
      id: ae1b8862-e82b-47d0-8ae0-eadc4807d547
      version: -1
      name: Azure - Enrichment
      playbookName: Azure - Enrichment
      type: playbook
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "2"
    separatecontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 450,
          "y": -190
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "28":
    id: "28"
    taskid: 823148f0-1a25-4fed-89df-e547cbb439f0
    type: title
    task:
      id: 823148f0-1a25-4fed-89df-e547cbb439f0
      version: -1
      name: Complete
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1190,
          "y": 2180
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "29":
    id: "29"
    taskid: ae79f855-35ff-4537-8e93-52fd790a8436
    type: regular
    task:
      id: ae79f855-35ff-4537-8e93-52fd790a8436
      version: -1
      name: Set ASM enrichment status field
      description: |-
        Automation used to more easily populate a grid field.  This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well.  Instead of a value you can enter `TIMESTAMP` to get the current timestamp in ISO format. For example:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "28"
    scriptarguments:
      gridfield:
        simple: asmenrichmentstatus
      keys:
        simple: source,record_exists,timestamp
      val1:
        simple: Azure
      val2:
        simple: ${asm_enrichment_flag_azure}
      val3:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1190,
          "y": 2000
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "30":
    id: "30"
    taskid: 6998bb92-e4f1-40a6-8b79-a59d147f02d9
    type: regular
    task:
      id: 6998bb92-e4f1-40a6-8b79-a59d147f02d9
      version: -1
      name: Set true flag for completed enrichment
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "33"
    scriptarguments:
      key:
        simple: asm_enrichment_flag_azure
      value:
        simple: "true"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1390,
          "y": 705
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "31":
    id: "31"
    taskid: 1daf027b-5ee5-4130-8420-e51ab179051a
    type: regular
    task:
      id: 1daf027b-5ee5-4130-8420-e51ab179051a
      version: -1
      name: Set true flag for completed enrichment
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "34"
    scriptarguments:
      key:
        simple: asm_enrichment_flag_azure
      value:
        simple: "true"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 750,
          "y": 705
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "32":
    id: "32"
    taskid: 913094b3-7aa4-4f2d-82f3-a6e25a841b2d
    type: title
    task:
      id: 913094b3-7aa4-4f2d-82f3-a6e25a841b2d
      version: -1
      name: System IDs - End
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "44"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 240,
          "y": 1580
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "33":
    id: "33"
    taskid: 47c37685-c7f7-45a9-82d1-2aafc6989bd9
    type: title
    task:
      id: 47c37685-c7f7-45a9-82d1-2aafc6989bd9
      version: -1
      name: Private IP - End
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "44"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1390,
          "y": 1010
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "34":
    id: "34"
    taskid: d49a09e2-3f7a-4fb1-8650-1918d96d733b
    type: title
    task:
      id: d49a09e2-3f7a-4fb1-8650-1918d96d733b
      version: -1
      name: Cloud - End
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "44"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 750,
          "y": 1010
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "38":
    id: "38"
    taskid: 70a659ac-bf48-4fd5-8950-00193780ed07
    type: regular
    task:
      id: 70a659ac-bf48-4fd5-8950-00193780ed07
      version: -1
      name: Set true flag for completed enrichment
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "32"
    scriptarguments:
      key:
        simple: asm_enrichment_flag_azure
      value:
        simple: "true"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 240,
          "y": 1385
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "39":
    id: "39"
    taskid: 97952f30-83ae-45ca-8416-ef7f6841166f
    type: regular
    task:
      id: 97952f30-83ae-45ca-8416-ef7f6841166f
      version: -1
      name: Set true flag for completed enrichment
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "40"
    scriptarguments:
      key:
        simple: asm_enrichment_flag_azure
      value:
        simple: "true"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -440,
          "y": 705
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "40":
    id: "40"
    taskid: 16fd2fd4-1edf-499f-87fe-d4fd3b21cff0
    type: title
    task:
      id: 16fd2fd4-1edf-499f-87fe-d4fd3b21cff0
      version: -1
      name: Service Owner - End
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "44"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -440,
          "y": 1145
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "42":
    id: "42"
    taskid: 915716bb-b717-422f-8205-8c861678dae3
    type: regular
    task:
      id: 915716bb-b717-422f-8205-8c861678dae3
      version: -1
      name: Set false flag for completed enrichment
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "32"
      - "40"
    scriptarguments:
      key:
        simple: asm_enrichment_flag_azure
      value:
        simple: "false"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -170,
          "y": 870
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "43":
    id: "43"
    taskid: 48c31407-55e2-4952-8136-0f4601bba6d5
    type: regular
    task:
      id: 48c31407-55e2-4952-8136-0f4601bba6d5
      version: -1
      name: Set false flag for completed enrichment
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "34"
      - "33"
    scriptarguments:
      key:
        simple: asm_enrichment_flag_azure
      value:
        simple: "false"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1060,
          "y": 830
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "44":
    id: "44"
    taskid: 2b88b0d6-ff07-4b41-8d9a-aa1c9a0980d1
    type: title
    task:
      id: 2b88b0d6-ff07-4b41-8d9a-aa1c9a0980d1
      version: -1
      name: Closing Steps
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "29"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1190,
          "y": 1860
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {
      "25_19_yes": 0.6,
      "3_9_yes": 0.5,
      "4_11_yes": 0.43,
      "7_18_yes": 0.5
    },
    "paper": {
      "dimensions": {
        "height": 2565,
        "width": 2210,
        "x": -440,
        "y": -320
      }
    }
  }
inputs:
- key: RemoteIP
  value:
    complex:
      root: inputs
      accessor: remoteip
  required: false
  description: IP address of the service.
  playbookInputQuery:
outputs: []
tests:
- No tests (auto formatted)
fromversion: 6.5.0
